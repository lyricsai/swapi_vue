"use strict";(self["webpackChunkswapi"]=self["webpackChunkswapi"]||[]).push([[45],{5367:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var s=a(3396),r=a(7139),i=a(3862);const h={key:0},u={key:1,class:"items__wrapper"},o={class:"items__info"},n={key:0},l={class:"item"},c={class:"page__wrapper"},p=["onClick"];function g(e,t,a,g,d,m){const w=(0,s.up)("search-bar"),y=(0,s.up)("k-dialog"),k=(0,s.up)("k-button"),_=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(y,{show:e.dialogSearchVisible,"onUpdate:show":t[2]||(t[2]=t=>e.dialogSearchVisible=!1)},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{ref:"search__input","onUpdate:show":t[0]||(t[0]=t=>e.dialogSearchVisible=t),"onUpdate:searchInput":t[1]||(t[1]=t=>e.searchQuery=t)},null,512)])),_:1},8,["show"]),(0,s.Wm)(k,{class:"search__button",onClick:e.showSearch},{default:(0,s.w5)((()=>[(0,s.Uk)("Search ")])),_:1},8,["onClick"]),(0,s.Wm)(k,{class:"search__button",onClick:e.resetSearchQuery},{default:(0,s.w5)((()=>[(0,s.Uk)("Reset ")])),_:1},8,["onClick"]),e.isLoading?((0,s.wg)(),(0,s.iD)("p",h,"Loading Data...")):((0,s.wg)(),(0,s.iD)("div",u,[(0,s._)("div",o,[(0,s._)("strong",null,(0,r.zw)(e.itemClass),1),(0,s.Uk)(" of the saga: ")]),e.items.length?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",n,"No such data")),(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.items,(t=>((0,s.wg)(),(0,s.j4)(_,{key:t,to:{path:`${e.itemClass}/${t.url.match(/\d/g).join("")}`}},{default:(0,s.w5)((()=>[(0,s._)("li",l,[(0,s._)("h2",null,(0,r.zw)(t.name??t.title),1)])])),_:2},1032,["to"])))),128))]),(0,s._)("ul",c,[(0,s.Wm)(k,{disabled:1===e.page,onClick:t[3]||(t[3]=(0,i.iM)((t=>e.changePage(e.page-1)),["prevent"]))},{default:(0,s.w5)((()=>[(0,s.Uk)("Back")])),_:1},8,["disabled"]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.totalPages,(t=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:(0,r.C_)(["page",{currentPage:e.page===t}]),onClick:a=>e.changePage(t)},[(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,r.zw)(t),1)])),_:2},1024)],10,p)))),128)),(0,s.Wm)(k,{disabled:e.page===e.totalPages,onClick:t[4]||(t[4]=(0,i.iM)((t=>e.changePage(e.page+1)),["prevent"]))},{default:(0,s.w5)((()=>[(0,s.Uk)("Forward")])),_:1},8,["disabled"])])]))],64)}a(7658);var d=a(3578);const m={for:"search__input"};function w(e,t,a,r,h,u){const o=(0,s.up)("k-input"),n=(0,s.up)("k-button");return(0,s.wg)(),(0,s.iD)("form",{onSubmit:t[1]||(t[1]=(0,i.iM)((()=>{}),["prevent"])),class:"search__bar"},[(0,s._)("label",m,[(0,s.Uk)("Look for "),(0,s.Wm)(o,{type:"text",modelValue:h.searchInput,"onUpdate:modelValue":t[0]||(t[0]=e=>h.searchInput=e),modelModifiers:{lazy:!0},id:"search__input",placeholder:"Type in.."},null,8,["modelValue"]),(0,s.Wm)(n,{onClick:(0,i.iM)(u.search,["prevent"])},{default:(0,s.w5)((()=>[(0,s.Uk)("Search")])),_:1},8,["onClick"])])],32)}var y={data(){return{searchInput:""}},methods:{search(){this.$emit("update:searchInput",this.searchInput),this.searchInput&&this.$emit("update:show",!1),this.searchInput=""}}},k=a(89);const _=(0,k.Z)(y,[["render",w]]);var b=_,f=(0,s.aZ)({name:"ItemsView",components:{SearchBar:b},data:()=>({items:null,isLoading:!1,pageNumber:1,totalPages:1,limit:10,page:1,searchQuery:"",dialogSearchVisible:!1}),created(){this.routeQuery.page||this.$router.push({name:this.routeName,query:{...this.routeQuery,page:1}}),this.page=Number(this.routeQuery.page),this.getItems()},methods:{async getItems(){try{this.isLoading=!0;const e=await(0,d.rQ)(d.HB[this.routeName],{search:this.routeQuery.search,page:Number(this.routeQuery.page)});this.items=e.results,this.totalPages=Math.ceil(e.count/this.limit)}catch(e){Promise.reject(e)}finally{this.isLoading=!1}},showSearch(){return this.dialogSearchVisible=!0},resetSearchQuery(){this.searchQuery="",this.routeHandler()},changePage(e){e<1||e>this.totalPages||(this.page=e,this.routeHandler(),this.getItems())},routeHandler(){this.$router.push({path:this.routeName,query:{search:this.searchQuery,page:Number(this.page)}})}},computed:{routeName(){return this.$route.name},itemClass(){return this.routeName},routeQuery(){return this.$route.query}},watch:{routeName(){this.getItems(),this.isLoading=!0,this.searchQuery="",this.page=1},searchQuery(){this.searchQuery&&(this.page=1,this.$router.push({path:this.routeName,query:{search:this.searchQuery,page:this.page}}),this.getItems())},routeQuery:{deep:!0,handler(){this.searchQuery=this.routeQuery.search||"",this.page=Number(this.routeQuery.page)||1,this.$nextTick((()=>{this.$router.push({path:this.routeName,query:{search:this.searchQuery,page:this.page}}),this.getItems()}))}}}});const Q=(0,k.Z)(f,[["render",g],["__scopeId","data-v-2ad95cf5"]]);var C=Q}}]);
//# sourceMappingURL=45.1e2e257e.js.map